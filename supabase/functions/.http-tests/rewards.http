# 奖励系统API测试
# Beehive Rewards System API Tests

@baseUrl = https://cvqibjcbfrwsgkvthccp.supabase.co/functions/v1
@apiKey = YOUR_SUPABASE_ANON_KEY_HERE
@serviceKey = YOUR_SUPABASE_SERVICE_ROLE_KEY_HERE

### Environment Variables
@testWallet = 0x2C84e7DC65209730C067827b49AC7d5A1d25C8dC
@testClaimId = replace-with-actual-claim-id

###############################################
# 1. 获取奖励余额 - Get Reward Balance
###############################################

### GET Reward Balance (Header)
GET {{baseUrl}}/rewards/user
Authorization: Bearer {{apiKey}}
x-wallet-address: {{testWallet}}

### POST Reward Balance (Body)
POST {{baseUrl}}/rewards/user
Authorization: Bearer {{apiKey}}
Content-Type: application/json

{
  "wallet_address": "{{testWallet}}"
}

###############################################
# 2. 获取可申请奖励 - Get Claimable Rewards
###############################################

### GET Claimable Rewards
GET {{baseUrl}}/rewards/claimable
Authorization: Bearer {{apiKey}}
x-wallet-address: {{testWallet}}

### POST Get Claims with Filters
POST {{baseUrl}}/rewards/claimable
Authorization: Bearer {{apiKey}}
Content-Type: application/json

{
  "wallet_address": "{{testWallet}}",
  "status": "claimable",
  "layer": 1
}

###############################################
# 3. 申请奖励 - Claim Reward
###############################################

### POST Claim Reward
POST {{baseUrl}}/rewards/claim
Authorization: Bearer {{apiKey}}
Content-Type: application/json

{
  "claim_id": "{{testClaimId}}",
  "wallet_address": "{{testWallet}}"
}

###############################################
# 4. 奖励通知 - Reward Notifications
###############################################

### POST Get Notifications
POST {{baseUrl}}/rewards/notifications
Authorization: Bearer {{apiKey}}
Content-Type: application/json

{
  "wallet_address": "{{testWallet}}",
  "limit": 20
}

### POST Get Unread Notifications
POST {{baseUrl}}/rewards/notifications
Authorization: Bearer {{apiKey}}
Content-Type: application/json

{
  "wallet_address": "{{testWallet}}",
  "is_read": false
}

###############################################
# 5. 待定奖励检查 - Pending Rewards Check
###############################################

### POST Check Pending Rewards
POST {{baseUrl}}/rewards/pending
Authorization: Bearer {{apiKey}}
Content-Type: application/json

{
  "wallet_address": "{{testWallet}}"
}

###############################################
# 6. 奖励计时器 - Reward Timers
###############################################

### POST Get Reward Timers
POST {{baseUrl}}/rewards/timers
Authorization: Bearer {{apiKey}}
Content-Type: application/json

{
  "wallet_address": "{{testWallet}}",
  "timer_type": "pending_reward"
}

###############################################
# 7. 奖励仪表板 - Reward Dashboard
###############################################

### POST Reward Dashboard
POST {{baseUrl}}/rewards/dashboard
Authorization: Bearer {{apiKey}}
Content-Type: application/json

{
  "wallet_address": "{{testWallet}}"
}

### GET Reward Dashboard Stats
GET {{baseUrl}}/rewards/stats
Authorization: Bearer {{apiKey}}
x-wallet-address: {{testWallet}}

###############################################
# 8. 提取奖励余额 - Withdraw Reward Balance
###############################################

### POST Withdraw Balance
POST {{baseUrl}}/rewards/withdraw
Authorization: Bearer {{serviceKey}}
Content-Type: application/json

{
  "wallet_address": "{{testWallet}}",
  "amount_usdc": 50.0,
  "withdrawal_address": "{{testWallet}}"
}

###############################################
# 9. 系统维护 - System Maintenance
###############################################

### POST Run Maintenance
POST {{baseUrl}}/rewards/maintenance
Authorization: Bearer {{serviceKey}}

###############################################
# 10. 更新奖励状态 - Update Reward Status
###############################################

### POST Update Reward Status
POST {{baseUrl}}/rewards/update-reward-status
Authorization: Bearer {{serviceKey}}
Content-Type: application/json

{
  "wallet_address": "{{testWallet}}",
  "claim_id": "{{testClaimId}}",
  "new_status": "claimable",
  "admin_override": true
}

###############################################
# 11. 处理过期奖励 - Process Expired Rewards
###############################################

### POST Process Expired Rewards
POST {{baseUrl}}/rewards/process-expired-rewards
Authorization: Bearer {{serviceKey}}

###############################################
# 12. 等级激活奖励 - Level Activation Rewards
###############################################

### POST Process Level Activation Rewards
POST {{baseUrl}}/rewards/process-level-activation-rewards
Authorization: Bearer {{serviceKey}}
Content-Type: application/json

{
  "memberWallet": "{{testWallet}}",
  "activatedLevel": 2,
  "rootWallet": "{{testWallet}}"
}

###############################################
# 13. 获取活动记录 - Get Activity Records
###############################################

### GET Activity Records
GET {{baseUrl}}/rewards/get-activity?limit=10
Authorization: Bearer {{apiKey}}
x-wallet-address: {{testWallet}}

### POST Activity Records
POST {{baseUrl}}/rewards/get-activity
Authorization: Bearer {{apiKey}}
Content-Type: application/json

{
  "walletAddress": "{{testWallet}}",
  "limit": 10
}